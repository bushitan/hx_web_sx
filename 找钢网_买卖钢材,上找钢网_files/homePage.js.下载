var banner={changebanner:function(){var a=new Swiper(".swiper-container",{autoplay:3000,pagination:".dots",simulateTouch:false,loop:true,paginationClickable:true,autoplayDisableOnInteraction:false,prevButton:".swiper-button-prev",nextButton:".swiper-button-next",})},fn_title_tab:function(){$(document).on("click",".title-tab li,.map-tab li,.me-tab-text li",function(){var a=$(this).index();$(this).addClass("active").siblings("li").removeClass("active")})},fn_quick:function(){var a=null;$(document).on({mouseenter:function(){var c=$(this).parents(".me-quick").find(".quick-hover");var d=$(this).parents(".me-quick").find(".quick-item");var e=$(this).parent().siblings();var b=$(this).attr("tag");if($(this).closest(".quick-top").length>0){c.removeClass("quick-hover-bottom")}else{c.addClass("quick-hover-bottom")}d.removeClass("active");$(this).addClass("active");clearTimeout(a);c.find(".quickitem").hide();c.find(".quickitem[tag="+b+"]").show();c.show()},mouseleave:function(){var b=$(this).parents(".me-quick").find(".quick-hover");var c=this;a=setTimeout(function(){$(c).removeClass("active");b.hide()},100)}},".me-quick .quick-item");$(document).on({mouseenter:function(){clearTimeout(a)},mouseleave:function(){var b=$(this).parents(".me-quick").find(".quick-item");b.removeClass("active");$(this).hide()}},".me-quick .quick-hover")},fn_quick_owner:function(){var a=null;$(document).on({mouseenter:function(){var b=$(this).parents(".me-tab").find(".tab-inner");var c=$(this).index();$(this).addClass("active").siblings("li").removeClass("active");b.hide().eq(c).show()},},".banner-me .me-tab-text li")},LoginOrReg:function(){$(".login-not #banner_right_login").click(function(){location.href=urlPath.zhaogangSSoUrl+"/login/index?loginType=0&jump="+encodeURI(location.href);return false});$(".login-not #banner_right_register").click(function(){location.href=urlPath.zhaogangSSoUrl+"/register";return false})},getUserImg:function(){$.ajax({url:"/ajax/getUserImg",dataType:"json",type:"post",success:function(b){if(b!=null){var a=tmpl($("#bannerLoginTmpl").html(),{data:b});$(".bannerRight .me-login .login-not").hide();$(".bannerRight .me-login .login-online").html(a);$(".bannerRight .me-login .login-online").show()}},error:function(){}})},init:function(){banner.changebanner();banner.fn_title_tab();banner.fn_quick();banner.fn_quick_owner();banner.LoginOrReg();banner.getUserImg()}};$(function(){banner.init()});var _pi={areaBasePriceSlick:undefined,init:function(){this.fn_more();this.initCity();this.initPriceAxis()},getToday:function(){var c=new Date();var a=c.getMonth()+1;var b=c.getDate();return(a<10?"0":"")+a+"月"+(b<10?"0":"")+b},fn_more:function(){$(".map-middle .more").mouseenter(function(){$(this).parent().addClass("showing");$(this).parent().find(".more-list").show()});$(document).on("mouseleave",".showing",function(){$(this).removeClass("showing");$(this).find(".more-list").hide()})},fn_slick_map:function(a){if(_pi.areaBasePriceSlick){_pi.areaBasePriceSlick.slick("unslick")}$(".map-slick").html(a);_pi.areaBasePriceSlick=$(".map-slick").slick({autoplay:false,draggable:false,arrows:true,dots:false})},initCity:function(){$.post("/index/queryAllAreas",{},function(c){if(c.success){var d=$.parseJSON(c.data);var b=d.data;if(b){var a=tmpl($("#indexCityTmpl").html(),{arr:b});$("#indexCity").append(a);$("#indexCity a[areaId]:first").click()}}});$("#indexCity").on("click","a",function(){$("#indexCity a.active").removeClass("active");$(this).addClass("active");$("#indexCurrentCity").html($(this).text()+"价格");_pi.areaBasePrice($(this).attr("areaId"))})},initPriceAxis:function(){$.post("/index/queryPriceAxis",{},function(e){if(e.success){var h=false;var b=[];var c={};var a={"普卷":"#47E1EA","螺纹":"#F28484","高线":"#8EB9F0","中厚板":"#F5D88E","冷轧卷":"#AF8FDF"};var f=[];var d=[];var i=[];$.each(e.data,function(j,l){if(l&&l!="null"){var k=$.parseJSON(l);i=i.concat(k.data);$.each(k.data,function(m,n){if("普卷螺纹".indexOf(n.categoryName)>=0){h=true}c[n.categoryName]=(j=="热卷"?true:false)})}});$.each(i[0].axisDatas,function(m,n){var k=n.priceDate;var l=1;for(var j=1;j<i.length;j++){$.each(i[j].axisDatas,function(o,p){if(k===p.priceDate){l++;return false}})}if(l===i.length){d.unshift(k)}});$.each(i,function(k,l){var j={name:l.categoryName,color:a[l.categoryName],type:"line",showSymbol:false,data:[],smooth:true};$.each(l.axisDatas,function(m,n){if($.inArray(n.priceDate,d)>=0){j.data.unshift(Math.round(n.price))}});f.push(j)});$.each(c,function(j,k){if(h){if("普卷螺纹".indexOf(j)>=0){c[j]=true;b.unshift(j)}else{c[j]=false;b.push(j)}}else{if(k){b.unshift(j)}else{b.push(j)}}});var g={xAxis_data:d,legend_data:b,legend_selected:c,series:f,};_pi.fn_trend_chart(g)}})},areaBasePrice:function(a){$.post("/index/queryBasePriceByArea",{areaId:a},function(d){if(d.success){var e=$.parseJSON(d.data);var c=e.data;if(c){$.each(c,function(f,g){g.priceIncreaseFormat=g.priceIncrease===0?"持平":((g.priceIncrease>=0?"+":"")+g.priceIncrease);g.priceClass=(g.priceIncrease===0?"level":(g.priceIncrease<0?"down":"up"));var h=g.priceDate.substr(5,11).replace("-","月");g.priceDateFormat=h.replace(_pi.getToday(),"今天")});var b=tmpl($("#basePriceTmpl").html(),{arr:c});_pi.fn_slick_map(b)}}})},fn_trend_chart:function(c){var a=echarts.init(document.getElementById("trend_chart"));var b={tooltip:{trigger:"axis"},xAxis:[{data:c.xAxis_data,axisLine:{show:true,lineStyle:{color:"#f2e8e8"}},axisTick:{show:true,interval:20},splitLine:{show:true,lineStyle:{color:"#f2e8e8"}},axisLabel:{color:"#999",margin:10,formatter:function(d,e){return d.slice(5)}},}],yAxis:[{axisLine:{show:true,lineStyle:{color:"#f2e8e8"}},axisTick:{show:false,},splitLine:{show:true,lineStyle:{color:"#f2e8e8"}},min:function(d){return Math.floor(parseInt(d.min)/100)*100-100},splitNumber:4,axisLabel:{color:"#999",margin:10,},}],legend:{icon:"path://m",itemWidth:1,itemGap:0,top:4,right:0,data:c.legend_data,selected:c.legend_selected},grid:{left:15,right:10,bottom:0,top:50,containLabel:true,},series:c.series};a.setOption(b)},};$(function(){_pi.init()});var factory={fn_slick_steel:function(){$(".steel-slick").slick({autoplay:true,autoplaySpeed:5000,draggable:false,arrows:true,slidesToShow:3,slidesToScroll:3})},recommendFactory:function(){$.post("/mall/recommendFactory",{},function(b){if(b.success&&b.data){var a=tmpl($("#recommendFactoryTmpl").html(),{arr:b.data});$(".steel-slick").html(a);if(b.data.length>3){factory.fn_slick_steel()}}})},recommendSeller:function(){$.post("/mall/recommendSeller",{},function(b){if(b.success&&b.data){var a=tmpl($("#recommendSellerTmpl").html(),{arr:b.data});$(".seller-content .seller-list").html(a)}})},init:function(){factory.recommendFactory();factory.recommendSeller()}};$(function(){factory.init()});var storePurOrd={fn_slick_shop_middle:function(){$(".shop-middle-slick").slick({autoplay:true,draggable:false,arrows:true,})},fn_slick_shop_right:function(){$(".shop-right-slick").slick({vertical:true,autoplay:true,draggable:false,arrows:true,slidesToShow:4,slidesToScroll:1})},initStorePic:function(){$(".section-shop").on("mouseenter",".rank-ewm",function(){if($(this).find(".img-ewm").length<=0){$(this).find(".share-ewm").html('<img src="'+$(this).find(".share-ewm").attr("src")+'" alt="" class="img-ewm">')}})},getStoreRankInfo:function(){$.ajax({url:"/qdCuohe/getStoreRankInfo",type:"POST",dataType:"json",success:function(b){if(b==null||b.success!=true){return}var c=b.data;var a=tmpl($("#storeRankInfoTmpl").html(),{arr:c});$("#storeRankInfo").html(a)}})},newPurchaseData:function(){$.ajax({url:"/qdCuohe/getQdCuoheNewPurchaseList",type:"POST",dataType:"json",success:function(b){if(b==null||b.success!=true){return}var c=b.data;var a=tmpl($("#newPurchaseDataTmpl").html(),{arr:c});$("#newPurchaseData").html(a);storePurOrd.fn_slick_shop_middle()}})},mallLatestOrder:function(){$.ajax({url:"/mall/mallLatestOrder",type:"POST",dataType:"json",success:function(c){var b=$.parseJSON(c.data);var a=tmpl($("#mallLatestOrderTmpl").html(),{arr:b});$("#mallLatestOrder").html(a);storePurOrd.fn_slick_shop_right()}})},dateFormat:function(c,a){if(!/^\d+$/g.test(c)){return""}var f=new Date(c);var e={"M+":f.getMonth()+1,"d+":f.getDate(),"h+":f.getHours(),"m+":f.getMinutes(),"s+":f.getSeconds(),"q+":Math.floor((f.getMonth()+3)/3),S:f.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(f.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in e){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(e[b]):(("00"+e[b]).substr((""+e[b]).length)))}}return a}};$(function(){storePurOrd.initStorePic();storePurOrd.mallLatestOrder();storePurOrd.newPurchaseData();storePurOrd.getStoreRankInfo()});var news={fn_img:function(){$(document).on("mouseenter",".product-description li",function(){$(this).stop().animate({width:380,},300).siblings("li").stop().animate({width:200,},300);$(this).find(".des-text").stop(true,true).fadeOut(50);$(this).siblings("li").find(".des-text").stop(true,true).fadeIn(50);$(this).find(".des-mask").stop(true,true).fadeIn(300).siblings("li").find(".des-mask").stop(true,true).fadeOut(300)});$(document).on("mouseleave",".product-description li",function(){var a=$(".product-description li");a.stop().animate({width:236,},300);a.find(".des-mask").stop(true,true).fadeOut(300);a.find(".des-text").stop(true,true).fadeIn(50)})},fn_loadBottomAd:function(){$.post(_base+"/ajax/getBottomAd",{},function(a){if(a&&a.success){var c=a.data;if(c&&c[0]){if(c[0].picture){if(c[0].link&&c[0].link!="-1"){$("#bottomAdPic").attr("href",c[0].link)}else{$("#bottomAdPic").removeAttr("target")}var b="<img src="+c[0].picture+">";$("#bottomAdPic").html(b);$(document).on("click",".fixed-ad .iconNew-fixedAdClose",function(){$(".fixed-ad").fadeOut()});$("#homePagebottomAd").show()}}}})},init:function(){this.fn_img();this.fn_loadBottomAd()}};$(function(){news.init()});